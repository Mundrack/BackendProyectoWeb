{
  "info": {
    "name": "FASE 3 - Plantillas de Auditoría",
    "description": "API completa para gestión de plantillas de auditoría basadas en estándares ISO",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://127.0.0.1:8000",
      "type": "string"
    },
    {
      "key": "token",
      "value": "",
      "type": "string"
    },
    {
      "key": "template_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "question_id",
      "value": "",
      "type": "string"
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{token}}",
        "type": "string"
      }
    ]
  },
  "item": [
    {
      "name": "Templates",
      "item": [
        {
          "name": "1. Listar todas las plantillas",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has results array\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('results');",
                  "    pm.expect(jsonData.results).to.be.an('array');",
                  "});",
                  "",
                  "if (pm.response.json().results.length > 0) {",
                  "    pm.collectionVariables.set(\"template_id\", pm.response.json().results[0].id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/templates/",
              "host": ["{{base_url}}"],
              "path": ["api", "templates", ""]
            },
            "description": "Obtiene todas las plantillas activas. Los owners ven también sus plantillas inactivas."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/templates/",
                  "host": ["{{base_url}}"],
                  "path": ["api", "templates", ""]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"count\": 1,\n  \"next\": null,\n  \"previous\": null,\n  \"results\": [\n    {\n      \"id\": 1,\n      \"name\": \"ISO 27701 - Gestión de Privacidad (Simplificada)\",\n      \"iso_standard\": \"27701\",\n      \"description\": \"Plantilla simplificada para auditorías de gestión de privacidad...\",\n      \"is_active\": true,\n      \"version\": 1,\n      \"total_questions\": 12,\n      \"max_possible_score\": 60,\n      \"created_by\": {\n        \"id\": 1,\n        \"email\": \"owner@example.com\",\n        \"full_name\": \"Owner User\"\n      },\n      \"created_at\": \"2025-12-30T17:30:00Z\",\n      \"updated_at\": \"2025-12-30T17:30:00Z\"\n    }\n  ]\n}"
            }
          ]
        },
        {
          "name": "2. Obtener una plantilla por ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has template data\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('id');",
                  "    pm.expect(jsonData).to.have.property('name');",
                  "    pm.expect(jsonData).to.have.property('total_questions');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/templates/{{template_id}}/",
              "host": ["{{base_url}}"],
              "path": ["api", "templates", "{{template_id}}", ""]
            },
            "description": "Obtiene los detalles de una plantilla específica."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/templates/1/",
                  "host": ["{{base_url}}"],
                  "path": ["api", "templates", "1", ""]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"id\": 1,\n  \"name\": \"ISO 27701 - Gestión de Privacidad (Simplificada)\",\n  \"iso_standard\": \"27701\",\n  \"description\": \"Plantilla simplificada para auditorías de gestión de privacidad y protección de datos personales basada en ISO 27701\",\n  \"is_active\": true,\n  \"version\": 1,\n  \"total_questions\": 12,\n  \"max_possible_score\": 60,\n  \"created_by\": {\n    \"id\": 1,\n    \"email\": \"owner@example.com\",\n    \"full_name\": \"Owner User\"\n  },\n  \"created_at\": \"2025-12-30T17:30:00Z\",\n  \"updated_at\": \"2025-12-30T17:30:00Z\"\n}"
            }
          ]
        },
        {
          "name": "3. Crear plantilla simple",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test(\"Template created successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('id');",
                  "    pm.expect(jsonData.name).to.eql('ISO 9001 - Sistema de Gestión de Calidad');",
                  "    pm.collectionVariables.set(\"template_id\", jsonData.id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"ISO 9001 - Sistema de Gestión de Calidad\",\n  \"iso_standard\": \"9001\",\n  \"description\": \"Plantilla básica para auditorías de calidad basada en ISO 9001\",\n  \"is_active\": true,\n  \"version\": 1\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/templates/",
              "host": ["{{base_url}}"],
              "path": ["api", "templates", ""]
            },
            "description": "Crea una plantilla vacía. Las preguntas se agregan después."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"ISO 9001 - Sistema de Gestión de Calidad\",\n  \"iso_standard\": \"9001\",\n  \"description\": \"Plantilla básica para auditorías de calidad basada en ISO 9001\",\n  \"is_active\": true,\n  \"version\": 1\n}"
                },
                "url": {
                  "raw": "{{base_url}}/api/templates/",
                  "host": ["{{base_url}}"],
                  "path": ["api", "templates", ""]
                }
              },
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"id\": 2,\n  \"name\": \"ISO 9001 - Sistema de Gestión de Calidad\",\n  \"iso_standard\": \"9001\",\n  \"description\": \"Plantilla básica para auditorías de calidad basada en ISO 9001\",\n  \"is_active\": true,\n  \"version\": 1,\n  \"total_questions\": 0,\n  \"max_possible_score\": 0,\n  \"created_by\": {\n    \"id\": 1,\n    \"email\": \"owner@example.com\",\n    \"full_name\": \"Owner User\"\n  },\n  \"created_at\": \"2025-12-30T18:00:00Z\",\n  \"updated_at\": \"2025-12-30T18:00:00Z\"\n}"
            }
          ]
        },
        {
          "name": "4. Crear plantilla con preguntas (bulk_create)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test(\"Template created with questions\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('id');",
                  "    pm.expect(jsonData.total_questions).to.eql(3);",
                  "    pm.collectionVariables.set(\"template_id\", jsonData.id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"ISO 27001 - Seguridad de la Información\",\n  \"iso_standard\": \"27001\",\n  \"description\": \"Plantilla completa con preguntas incluidas\",\n  \"is_active\": true,\n  \"version\": 1,\n  \"questions\": [\n    {\n      \"category\": \"Gestión de Activos\",\n      \"question_text\": \"¿Se mantiene un inventario actualizado de todos los activos de información?\",\n      \"order_num\": 1,\n      \"max_score\": 5,\n      \"is_required\": true,\n      \"help_text\": \"Verificar que exista un inventario completo y actualizado.\"\n    },\n    {\n      \"category\": \"Gestión de Activos\",\n      \"question_text\": \"¿Se han clasificado los activos según su criticidad?\",\n      \"order_num\": 2,\n      \"max_score\": 5,\n      \"is_required\": true,\n      \"help_text\": \"Revisar esquema de clasificación de activos.\"\n    },\n    {\n      \"category\": \"Control de Acceso\",\n      \"question_text\": \"¿Existe una política formal de control de acceso?\",\n      \"order_num\": 3,\n      \"max_score\": 5,\n      \"is_required\": true,\n      \"help_text\": \"Verificar documento de política de control de acceso.\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/templates/bulk_create/",
              "host": ["{{base_url}}"],
              "path": ["api", "templates", "bulk_create", ""]
            },
            "description": "Crea una plantilla con todas sus preguntas en una sola petición."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"ISO 27001 - Seguridad de la Información\",\n  \"iso_standard\": \"27001\",\n  \"description\": \"Plantilla completa con preguntas incluidas\",\n  \"is_active\": true,\n  \"version\": 1,\n  \"questions\": [\n    {\n      \"category\": \"Gestión de Activos\",\n      \"question_text\": \"¿Se mantiene un inventario actualizado de todos los activos de información?\",\n      \"order_num\": 1,\n      \"max_score\": 5,\n      \"is_required\": true,\n      \"help_text\": \"Verificar que exista un inventario completo y actualizado.\"\n    },\n    {\n      \"category\": \"Gestión de Activos\",\n      \"question_text\": \"¿Se han clasificado los activos según su criticidad?\",\n      \"order_num\": 2,\n      \"max_score\": 5,\n      \"is_required\": true,\n      \"help_text\": \"Revisar esquema de clasificación de activos.\"\n    },\n    {\n      \"category\": \"Control de Acceso\",\n      \"question_text\": \"¿Existe una política formal de control de acceso?\",\n      \"order_num\": 3,\n      \"max_score\": 5,\n      \"is_required\": true,\n      \"help_text\": \"Verificar documento de política de control de acceso.\"\n    }\n  ]\n}"
                },
                "url": {
                  "raw": "{{base_url}}/api/templates/bulk_create/",
                  "host": ["{{base_url}}"],
                  "path": ["api", "templates", "bulk_create", ""]
                }
              },
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"id\": 3,\n  \"name\": \"ISO 27001 - Seguridad de la Información\",\n  \"iso_standard\": \"27001\",\n  \"description\": \"Plantilla completa con preguntas incluidas\",\n  \"is_active\": true,\n  \"version\": 1,\n  \"total_questions\": 3,\n  \"max_possible_score\": 15,\n  \"created_by\": {\n    \"id\": 1,\n    \"email\": \"owner@example.com\",\n    \"full_name\": \"Owner User\"\n  },\n  \"created_at\": \"2025-12-30T18:05:00Z\",\n  \"updated_at\": \"2025-12-30T18:05:00Z\"\n}"
            }
          ]
        },
        {
          "name": "5. Actualizar plantilla",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Template updated successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.version).to.eql(2);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"ISO 9001 - Sistema de Gestión de Calidad (v2)\",\n  \"iso_standard\": \"9001\",\n  \"description\": \"Plantilla actualizada con mejoras\",\n  \"is_active\": true,\n  \"version\": 2\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/templates/{{template_id}}/",
              "host": ["{{base_url}}"],
              "path": ["api", "templates", "{{template_id}}", ""]
            },
            "description": "Actualiza todos los campos de una plantilla existente."
          },
          "response": []
        },
        {
          "name": "6. Actualización parcial de plantilla",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Template patched successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.is_active).to.eql(false);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"is_active\": false\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/templates/{{template_id}}/",
              "host": ["{{base_url}}"],
              "path": ["api", "templates", "{{template_id}}", ""]
            },
            "description": "Actualiza solo campos específicos de una plantilla."
          },
          "response": []
        },
        {
          "name": "7. Obtener preguntas de una plantilla",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response contains questions array\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});",
                  "",
                  "if (pm.response.json().length > 0) {",
                  "    pm.collectionVariables.set(\"question_id\", pm.response.json()[0].id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/templates/{{template_id}}/questions/",
              "host": ["{{base_url}}"],
              "path": ["api", "templates", "{{template_id}}", "questions", ""]
            },
            "description": "Obtiene todas las preguntas de una plantilla ordenadas por order_num."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/templates/1/questions/",
                  "host": ["{{base_url}}"],
                  "path": ["api", "templates", "1", "questions", ""]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "[\n  {\n    \"id\": 1,\n    \"template\": 1,\n    \"category\": \"Política y Organización\",\n    \"question_text\": \"¿Existe una política de privacidad documentada y aprobada por la dirección?\",\n    \"order_num\": 1,\n    \"max_score\": 5,\n    \"is_required\": true,\n    \"help_text\": \"Verificar que exista un documento formal de política de privacidad aprobado por la alta dirección y que esté actualizado.\",\n    \"created_at\": \"2025-12-30T17:30:00Z\"\n  },\n  {\n    \"id\": 2,\n    \"template\": 1,\n    \"category\": \"Política y Organización\",\n    \"question_text\": \"¿Se ha designado un responsable de protección de datos (DPO o equivalente)?\",\n    \"order_num\": 2,\n    \"max_score\": 5,\n    \"is_required\": true,\n    \"help_text\": \"Confirmar que existe una persona designada formalmente como responsable de la protección de datos personales.\",\n    \"created_at\": \"2025-12-30T17:30:00Z\"\n  }\n]"
            }
          ]
        },
        {
          "name": "8. Obtener categorías de una plantilla",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response contains categories\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('categories');",
                  "    pm.expect(jsonData.categories).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/templates/{{template_id}}/categories/",
              "host": ["{{base_url}}"],
              "path": ["api", "templates", "{{template_id}}", "categories", ""]
            },
            "description": "Obtiene las preguntas agrupadas por categoría con estadísticas."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/templates/1/categories/",
                  "host": ["{{base_url}}"],
                  "path": ["api", "templates", "1", "categories", ""]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"template_id\": 1,\n  \"template_name\": \"ISO 27701 - Gestión de Privacidad (Simplificada)\",\n  \"categories\": [\n    {\n      \"category\": \"Política y Organización\",\n      \"question_count\": 3,\n      \"total_score\": 15,\n      \"questions\": [\n        {\n          \"id\": 1,\n          \"question_text\": \"¿Existe una política de privacidad documentada y aprobada por la dirección?\",\n          \"order_num\": 1,\n          \"max_score\": 5,\n          \"is_required\": true\n        },\n        {\n          \"id\": 2,\n          \"question_text\": \"¿Se ha designado un responsable de protección de datos (DPO o equivalente)?\",\n          \"order_num\": 2,\n          \"max_score\": 5,\n          \"is_required\": true\n        },\n        {\n          \"id\": 3,\n          \"question_text\": \"¿Se comunica la política de privacidad a todos los empleados y se brinda capacitación regular?\",\n          \"order_num\": 3,\n          \"max_score\": 5,\n          \"is_required\": true\n        }\n      ]\n    },\n    {\n      \"category\": \"Gestión de Datos Personales\",\n      \"question_count\": 3,\n      \"total_score\": 15,\n      \"questions\": []\n    }\n  ]\n}"
            }
          ]
        },
        {
          "name": "9. Duplicar plantilla",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test(\"Template duplicated successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('id');",
                  "    pm.expect(jsonData.name).to.include('(Copia)');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/templates/{{template_id}}/duplicate/",
              "host": ["{{base_url}}"],
              "path": ["api", "templates", "{{template_id}}", "duplicate", ""]
            },
            "description": "Duplica una plantilla existente con todas sus preguntas."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/templates/1/duplicate/",
                  "host": ["{{base_url}}"],
                  "path": ["api", "templates", "1", "duplicate", ""]
                }
              },
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"id\": 4,\n  \"name\": \"ISO 27701 - Gestión de Privacidad (Simplificada) (Copia)\",\n  \"iso_standard\": \"27701\",\n  \"description\": \"Plantilla simplificada para auditorías de gestión de privacidad...\",\n  \"is_active\": false,\n  \"version\": 1,\n  \"total_questions\": 12,\n  \"max_possible_score\": 60,\n  \"created_by\": {\n    \"id\": 1,\n    \"email\": \"owner@example.com\",\n    \"full_name\": \"Owner User\"\n  },\n  \"created_at\": \"2025-12-30T18:15:00Z\",\n  \"updated_at\": \"2025-12-30T18:15:00Z\"\n}"
            }
          ]
        },
        {
          "name": "10. Eliminar plantilla",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 204\", function () {",
                  "    pm.response.to.have.status(204);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/templates/{{template_id}}/",
              "host": ["{{base_url}}"],
              "path": ["api", "templates", "{{template_id}}", ""]
            },
            "description": "Elimina una plantilla y todas sus preguntas asociadas."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Questions",
      "item": [
        {
          "name": "1. Listar todas las preguntas",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has results array\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('results');",
                  "    pm.expect(jsonData.results).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/questions/?template={{template_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "questions", ""],
              "query": [
                {
                  "key": "template",
                  "value": "{{template_id}}"
                }
              ]
            },
            "description": "Lista todas las preguntas. Puede filtrarse por template, category, o is_required."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/questions/?template=1",
                  "host": ["{{base_url}}"],
                  "path": ["api", "questions", ""],
                  "query": [
                    {
                      "key": "template",
                      "value": "1"
                    }
                  ]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"count\": 12,\n  \"next\": null,\n  \"previous\": null,\n  \"results\": [\n    {\n      \"id\": 1,\n      \"template\": 1,\n      \"category\": \"Política y Organización\",\n      \"question_text\": \"¿Existe una política de privacidad documentada y aprobada por la dirección?\",\n      \"order_num\": 1,\n      \"max_score\": 5,\n      \"is_required\": true,\n      \"help_text\": \"Verificar que exista un documento formal de política de privacidad aprobado por la alta dirección y que esté actualizado.\",\n      \"created_at\": \"2025-12-30T17:30:00Z\"\n    }\n  ]\n}"
            }
          ]
        },
        {
          "name": "2. Obtener una pregunta por ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has question data\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('id');",
                  "    pm.expect(jsonData).to.have.property('question_text');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/questions/{{question_id}}/",
              "host": ["{{base_url}}"],
              "path": ["api", "questions", "{{question_id}}", ""]
            },
            "description": "Obtiene los detalles de una pregunta específica."
          },
          "response": []
        },
        {
          "name": "3. Crear pregunta",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test(\"Question created successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('id');",
                  "    pm.expect(jsonData.category).to.eql('Control de Acceso');",
                  "    pm.collectionVariables.set(\"question_id\", jsonData.id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"template\": {{template_id}},\n  \"category\": \"Control de Acceso\",\n  \"question_text\": \"¿Se revisan periódicamente los permisos de acceso de los usuarios?\",\n  \"order_num\": 13,\n  \"max_score\": 5,\n  \"is_required\": true,\n  \"help_text\": \"Verificar que existe un proceso de revisión periódica de permisos.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/questions/",
              "host": ["{{base_url}}"],
              "path": ["api", "questions", ""]
            },
            "description": "Crea una nueva pregunta en una plantilla existente."
          },
          "response": []
        },
        {
          "name": "4. Actualizar pregunta",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Question updated successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.max_score).to.eql(10);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"template\": {{template_id}},\n  \"category\": \"Control de Acceso\",\n  \"question_text\": \"¿Se revisan periódicamente los permisos de acceso de los usuarios?\",\n  \"order_num\": 13,\n  \"max_score\": 10,\n  \"is_required\": true,\n  \"help_text\": \"Verificar que existe un proceso de revisión periódica de permisos al menos cada 6 meses.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/questions/{{question_id}}/",
              "host": ["{{base_url}}"],
              "path": ["api", "questions", "{{question_id}}", ""]
            },
            "description": "Actualiza todos los campos de una pregunta existente."
          },
          "response": []
        },
        {
          "name": "5. Reordenar preguntas",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Questions reordered successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('message');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question_orders\": [\n    {\"id\": 1, \"order_num\": 2},\n    {\"id\": 2, \"order_num\": 1},\n    {\"id\": 3, \"order_num\": 3}\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/questions/reorder/",
              "host": ["{{base_url}}"],
              "path": ["api", "questions", "reorder", ""]
            },
            "description": "Reordena múltiples preguntas de una plantilla en una sola operación."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"question_orders\": [\n    {\"id\": 1, \"order_num\": 2},\n    {\"id\": 2, \"order_num\": 1},\n    {\"id\": 3, \"order_num\": 3}\n  ]\n}"
                },
                "url": {
                  "raw": "{{base_url}}/api/questions/reorder/",
                  "host": ["{{base_url}}"],
                  "path": ["api", "questions", "reorder", ""]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": "{\n  \"message\": \"3 preguntas reordenadas correctamente\",\n  \"updated_questions\": 3\n}"
            }
          ]
        },
        {
          "name": "6. Eliminar pregunta",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 204\", function () {",
                  "    pm.response.to.have.status(204);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/questions/{{question_id}}/",
              "host": ["{{base_url}}"],
              "path": ["api", "questions", "{{question_id}}", ""]
            },
            "description": "Elimina una pregunta específica de una plantilla."
          },
          "response": []
        }
      ]
    }
  ]
}
